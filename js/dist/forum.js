(()=>{var t={619:t=>{function e(t){return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}e.keys=()=>[],e.resolve=e,e.id=619,t.exports=e}},e={};function r(o){flarum.reg._webpack_runtimes["flectar-turnstile"]||=r;var n=e[o];if(void 0!==n)return n.exports;var a=e[o]={exports:{}};return t[o](a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=flarum.reg.get("core","common/extend");function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function o(t,r,o){return(r=function(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}class n{constructor(t,e){o(this,"token",null),o(this,"widgetId",void 0),o(this,"callback",void 0),o(this,"errorCallback",void 0),this.callback=t,this.errorCallback=e}render(t,e){void 0===e&&(e="auto"),window.turnstile&&(this.widgetId=window.turnstile.render(t,{sitekey:flarum.forum.attribute("flectar-turnstile.site_key"),theme:e,size:"normal",callback:t=>{this.token=t,this.callback(t)},"expired-callback":()=>{this.token=null},"error-callback":()=>{this.token=null,this.errorCallback({type:"error",content:flarum.translator.trans("flectar-turnstile.forum.error")})}}))}getResponse(){return this.token}reset(){this.widgetId&&(window.turnstile.reset(this.widgetId),this.token=null)}isReady(){return void 0!==window.turnstile}}flarum.reg.add("flectar-turnstile","common/states/TurnstileState",n);const a=flarum.reg.get("core","common/Component");var i=r.n(a);class s extends(i()){oncreate(t){super.oncreate(t);const e=this.detectTheme();this.attrs.state.render(t.dom.querySelector(".cf-turnstile"),e)}detectTheme(){return(document.documentElement.dataset.theme||"light").startsWith("dark")?"dark":"light"}view(){return m("div",{className:"Form-group"},m("div",{className:"cf-turnstile"}))}}flarum.reg.add("flectar-turnstile","forum/components/Turnstile",s);const l=e=>{let{modulePath:o,type:a,dataMethod:i}=e;r(619)(o).then((e=>{const r=e.default,l=()=>!!flarum.forum.attribute(`flectar-turnstile.${a}`);(0,t.override)(r.prototype,"oninit",(function(t){t(),l()&&(this.turnstile=new n((()=>{}),(t=>{this.loaded?.(),this.alertAttrs=t})))})),(0,t.override)(r.prototype,i,(function(t){const e=t();return l()?(e.turnstileToken=this.turnstile.getResponse(),e):e})),(0,t.override)(r.prototype,"fields",(function(t){const e=t();if(!l())return e;const r=o.includes("ChangePasswordModal")?10:-5;return e.add("turnstile",m(s,{state:this.turnstile}),r),e})),(0,t.override)(r.prototype,"onerror",(function(t,e){t(e),l()&&(this.turnstile.reset(),!e.alert||e.alert.content&&e.alert.content.length||(e.alert.content=flarum.translator.trans("flectar-turnstile.forum.validation_error")),this.alertAttrs=e.alert,this.onready?.())}))}))};l({modulePath:"flarum/forum/components/ForgotPasswordModal",type:"forgot",dataMethod:"requestParams"}),l({modulePath:"flarum/forum/components/LogInModal",type:"signin",dataMethod:"loginParams"}),l({modulePath:"flarum/forum/components/SignUpModal",type:"signup",dataMethod:"submitData"}),l({modulePath:"flarum/forum/components/ChangePasswordModal",type:"forgot",dataMethod:"requestBody"})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map